---
tags: [golang, concurrency, goroutine]
aliases: [Go –ì–æ—Ä—É—Ç–∏–Ω—ã, Go –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º]
---

# üèÉ –ì–æ—Ä—É—Ç–∏–Ω—ã (Goroutines)

–ì–æ—Ä—É—Ç–∏–Ω—ã ‚Äî —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —Å—Ä–µ–¥–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Go. –û–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–æ–¥–µ–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ Go.

## 1. –ó–∞–ø—É—Å–∫ –ì–æ—Ä—É—Ç–∏–Ω—ã

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –Ω–æ–≤–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `go`.

```go
func f(from string) {
	for i := 0; i < 3; i++ {
		fmt.Println(from, ":", i)
	}
}

func main() {
	f("direct") // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

	go f("goroutine") // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ –Ω–æ–≤–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ

	// –ó–∞–ø—É—Å–∫ –∞–Ω–æ–Ω–∏–º–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≥–æ—Ä—É—Ç–∏–Ω–µ
	go func(msg string) {
		fmt.Println(msg)
	}("going")

	// –ì–ª–∞–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ –¥—Ä—É–≥–∏–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è.
	// –í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ sync.WaitGroup –∏–ª–∏ –∫–∞–Ω–∞–ª—ã.
	time.Sleep(time.Second)
	fmt.Println("done")
}
```

## 2. –ú–æ–¥–µ–ª—å –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ Go

Go –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å **CSP (Communicating Sequential Processes)**, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (–≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏) —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª—ã.

> **–ò–¥–∏–æ–º–∞ Go:** –ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–±—â–µ–π –ø–∞–º—è—Ç–∏; –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ **–ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø–∞–º—è—Ç—å –ø–æ –∫–∞–Ω–∞–ª–∞–º**.

## 3. `sync.WaitGroup`

`sync.WaitGroup` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–∞–±–æ—Ä–∞ –≥–æ—Ä—É—Ç–∏–Ω.

| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `Add(delta int)` | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫. |
| `Done()` | –£–º–µ–Ω—å—à–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –Ω–∞ 1 (–æ–±—ã—á–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `defer`). |
| `Wait()` | –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —Å—á–µ—Ç—á–∏–∫ –Ω–µ —Å—Ç–∞–Ω–µ—Ç 0. |

```go
func worker(id int, wg *sync.WaitGroup) {
	defer wg.Done() // –£–º–µ–Ω—å—à–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
	fmt.Printf("Worker %d starting\n", id)
	time.Sleep(time.Second)
	fmt.Printf("Worker %d finished\n", id)
}

func main() {
	var wg sync.WaitGroup

	for i := 1; i <= 5; i++ {
		wg.Add(1) // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
		go worker(i, &wg)
	}

	wg.Wait() // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –≥–æ—Ä—É—Ç–∏–Ω
	fmt.Println("All workers finished")
}
```
